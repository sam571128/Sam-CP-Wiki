---
description: 遇到修改連續區間時，紀錄下來之後再做不就好了嗎？
---

# 線段樹（三）

在看這章節前，若尚未學過單點修改的線段樹，請點選以下連結

{% page-ref page="segment-tree-1.md" %}

### 區間修改 單點詢問

我們已經學過單點修改的線段樹可以在 $$O(\log n)$$的時間內完成，那麼如果我們今天只是要在修改後，詢問某一個位置的值，那麼我們其實可以使用一種技巧，也就是「差分」！

設一個陣列 $$A$$ 的元素為以下

$$
A[0], \ A[1], \ A[2], \ ..., \ A[n]
$$

在進行區間修改 $$[l,r]$$ 時，如果我們每一個點都去修改他的值，我們要花的時間為 $$O((r-l+1)\log n) \approx O(n \log n)$$ ，實在不是一個非常好的作法

如果我們用另外一個陣列 $$B$$ 存陣列 $$A$$ 兩兩元素之間的差距呢？ 也就是如下

$$
A[1] - A[0], \ A[2] - A[1], \ A[3] - A[2], ..., \ A[n] - A[n-1]
$$

那其實只需要讓 $$B[l]$$ 去加上區間所要加的值，以及 $$B[r+1]$$ 去減掉區間加的值

當我們在詢問 $$A[i]$$ 時，只要詢問陣列$$B$$ 的前 $$i$$ 項之和，即可得到答案

時間複雜度：區間加值 $$O(\log n)$$ ，單點求值 $$O(\log n)$$ 

### 區間修改 區間詢問



